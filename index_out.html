<!doctype html>
<html>
<head>
    <title>JS1k, 1k demo submission [ID]</title>
    <meta charset="utf-8" />
</head>
<body>
<canvas id="c"></canvas>
<script>
    var b = document.body;
    var c = document.getElementsByTagName('canvas')[0];
    var a = c.getContext('2d');
    document.body.clientWidth; // fix bug in webkit: http://qfox.nl/weblog/218
</script>
<script>
    function g(e,i){var h=(e[0]+e[1]+e[2])*i;return[e[0]+h,e[1]+h,e[2]+h]}for(var j=1/3,k=-1/6,m=[[1,1,0],[-1,1,0],[1,-1,0],[-1,-1,0],[1,0,1],[-1,0,1],[1,0,-1],[-1,0,-1],[0,1,1],[0,-1,1],[0,1,-1],[0,-1,-1]],n=m.length,s=[],t=0;512>t;t++)s[t]=~~(256*Math.random());function u(e,i){var h=0.6-(e[0]*e[0]+e[1]*e[1]+e[2]*e[2]);return 0>h?0:Math.pow(h,4)*(e[0]*i[0]+e[1]*i[1]+e[2]*i[2])}document.body.style.cssText="margin: 0; padding: 0";var v=c.width=window.innerWidth,w=c.height=window.innerHeight;
img=a.createImageData(v,w);time=0;
function x(){for(var e=0;e<v;e++)for(var i=0;i<w;i++){var h=4*(e+i*v),b=0.01*e,o=0.01*i,p=0.01*time,f=g([b,o,p],j),f=[~~f[0],~~f[1],~~f[2]],l=g(f,k),b=[b-l[0],o-l[1],p-l[2]],d=b[0]>=b[1]?b[1]>=b[2]?[[1,0,0],[1,1,0]]:b[0]>=b[2]?[[1,0,0],[1,0,1]]:[[0,0,1],[1,0,1]]:b[1]<b[2]?[[0,0,1],[0,1,1]]:b[0]<b[2]?[[0,1,0],[0,1,1]]:[[0,1,0],[1,1,0]],o=b[0]-d[0][0]-k,p=b[1]-d[0][1]-k,l=b[2]-d[0][2]-k,y=b[0]-d[1][0]-2*k,z=b[1]-d[1][1]-2*k,A=b[2]-d[1][2]-2*k,B=b[0]-1-3*k,C=b[1]-1-3*k,D=b[2]-1-3*k,q=f[0]%255,r=f[1]%
255,f=f[2]%255,f=[m[s[q+s[r+s[f]]]%12%n],m[s[q+d[0][0]+s[r+d[0][1]+s[f+d[0][2]]]]%12%n],m[s[q+d[1][0]+s[r+d[1][1]+s[f+d[1][2]]]]%12%n],m[s[q+1+s[r+1+s[f+1]]]%12%n]],d=0,d=d+u(b,f[0]),d=d+u([o,p,l],f[1]),d=d+u([y,z,A],f[2]),d=d+u([B,C,D],f[3]);img.data[h+0]=img.data[h+1]=img.data[h+2]=128*(32*d+1);img.data[h+3]=255}a.putImageData(img,0,0);time++;setTimeout(x,0)}x();

</script>
</body>
</html>
